/*! gaw-input-tag - v1.1.13 - 2019-03-15 */


!function(){"use strict";angular.module("bb.inputTag.tmpl",[]).run(["$templateCache",function(a){a.put("bb/auto-complete-match.html",'<span ng-bind-html="$highlight($getDisplayText())"></span>'),a.put("bb/auto-complete.html",'<div class="autocomplete" ng-if="suggestionList.visible">\n  <ul \nclass="suggestion-list">\n    <li class="suggestion-item" \nng-repeat="item in suggestionList.items track by track(item)" \nng-class="getSuggestionClass(item, $index)" \nng-click="addSuggestionByIndex($index)" \nng-mouseenter="suggestionList.select($index)">\n      <ti-autocomplete-match \nscope="templateScope" data="::item"></ti-autocomplete-match>\n    </li>\n  </ul>\n\n</div>'),a.put("bb/input-tag.html",'<div class="host" ng-click="eventHandlers.host.click()" ti-transclude-append>\n  <div class="tags" ng-class="{focused: hasFocus}" tabindex="0" \naria-label="Lista de tags.">\n    <ul class="tag-list" aria-live="polite" \naria-atomic="true" aria-role="list">\n      <li class="tag-item" \naria-role="listitem" ng-repeat="tag in tagList.items track by track(tag)" \nng-class="getTagClass(tag, $index)" ng-click="eventHandlers.tag.click(tag)" \ntabindex="0">\n        <ti-tag-item scope="templateScope" data="::tag">\n</ti-tag-item>\n      </li>\n    </ul>\n    <input class="input" \naria-label="{{options.bbPlaceholder}}. Digite a tag a ser incluÃ­da e pressione enter." \nautocomplete="off" ng-model="newTag.text" \nng-model-options="{getterSetter: true}" \nng-keydown="eventHandlers.input.keydown($event)" \nng-focus="eventHandlers.input.focus($event)" \nng-blur="eventHandlers.input.blur($event)" \nng-paste="eventHandlers.input.paste($event)" ng-trim="false" \nng-class="{\'invalid-tag\': newTag.invalid}" ng-disabled="disabled" \nti-bind-attrs="{type: options.bbType, placeholder: options.bbPlaceholder, tabindex: options.bbTabindex, spellcheck: options.bbSpellcheck}" \nti-autosize>\n  </div>\n</div>\n'),a.put("bb/tag-item.html",'<span ng-bind="$getDisplayText()" \naria-label="Tag: {{$getDisplayText()}}. Pressione tab e em seguida Enter para ">\n</span>\n<a href class="remove-button" ng-click="$removeTag()" \nng-bind="::$$removeTagSymbol" \naria-label="remover a tag \'{{$getDisplayText()}}\'."></a>')}])}(),function(a){"use strict";function b(){var b={},c={},d=3;this.setDefaults=function(a,c){return b[a]=c,this},this.setActiveInterpolation=function(a,b){return c[a]=b,this},this.setTextAutosizeThreshold=function(a){return d=a,this},this.$get=["$interpolate",function(e){var f={};return f[String]=function(a){return a},f[Number]=function(a){return parseInt(a,10)},f[Boolean]=function(a){return"true"===a.toLowerCase()},f[RegExp]=function(a){return new RegExp(a)},{load:function(d,g,h,i){var j=function(){return!0};g.options={},a.forEach(i,function(i,k){var l,m,n,o,p,q;l=i[0],m=i[1],n=i[2]||j,o=f[l],p=function(){var c=b[d]&&b[d][k];return a.isDefined(c)?c:m},q=function(a){g.options[k]=a&&n(a)?o(a):p()},c[d]&&c[d][k]?h.$observe(k,function(a){q(a),g.events.trigger("option-change",{name:k,newValue:a})}):q(h[k]&&e(h[k])(g.$parent))})},getTextAutosizeThreshold:function(){return d}}}]}function c(b,c){var d={};return d.debounce=function(a,c){var d;return function(){var e=arguments;b.cancel(d),d=b(function(){a.apply(null,e)},c)}},d.makeObjectArray=function(b,c){if(!a.isArray(b)||0===b.length||a.isObject(b[0]))return b;var d=[];return b.forEach(function(a){var b={};b[c]=a,d.push(b)}),d},d.findInObjectArray=function(a,b,c,e){var f=null;return e=e||d.defaultComparer,a.some(function(a){if(e(a[c],b[c]))return f=a,!0}),f},d.defaultComparer=function(a,b){return d.safeToString(a).toLowerCase()===d.safeToString(b).toLowerCase()},d.safeHighlight=function(a,b){if(!b)return a;a=d.encodeHTML(a),b=d.encodeHTML(b);var c=new RegExp("&[^;]+;|"+function(a){return a.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}(b),"gi");return a.replace(c,function(a){return a.toLowerCase()===b.toLowerCase()?"<em>"+a+"</em>":a})},d.safeToString=function(b){return a.isUndefined(b)||null==b?"":b.toString().trim()},d.encodeHTML=function(a){return d.safeToString(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},d.handleUndefinedResult=function(b,c){return function(){var d=b.apply(null,arguments);return a.isUndefined(d)?c:d}},d.replaceSpacesWithDashes=function(a){return d.safeToString(a).replace(/\s/g,"-")},d.isModifierOn=function(a){return a.shiftKey||a.ctrlKey||a.altKey||a.metaKey},d.promisifyValue=function(b){return b=!!a.isUndefined(b)||b,c[b?"when":"reject"]()},d.simplePubSub=function(){var a={};return{on:function(b,c,d){return b.split(" ").forEach(function(b){a[b]||(a[b]=[]),(d?[].unshift:[].push).call(a[b],c)}),this},trigger:function(b,c){return(a[b]||[]).every(function(a){return d.handleUndefinedResult(a,!0)(c)}),this}}},d}function d(b,c,d,e,f,g){function h(a,b,c,d){var f,h,i,j,k={};return f=function(b){return g.safeToString(b[a.bbDisplayProperty])},h=function(b,c){b[a.bbDisplayProperty]=c},i=function(b){var d=f(b),h=d&&d.length>=a.bbMinLength&&d.length<=a.bbMaxLength&&a.bbAllowedTagsPattern.test(d)&&!g.findInObjectArray(k.items,b,a.bbKeyProperty||a.bbDisplayProperty);return e.when(h&&c({$tag:b})).then(g.promisifyValue)},j=function(a){return e.when(d({$tag:a})).then(g.promisifyValue)},k.items=[],k.addText=function(a){var b={};return h(b,a),k.add(b)},k.add=function(c){var d=f(c);return a.bbReplaceSpacesWithDashes&&(d=g.replaceSpacesWithDashes(d)),h(c,d),i(c).then(function(){k.items.push(c),b.trigger("tag-added",{$tag:c})}).catch(function(){d&&b.trigger("invalid-tag",{$tag:c})})},k.remove=function(a){var c=k.items[a];return j(c).then(function(){return k.items.splice(a,1),k.clearSelection(),b.trigger("tag-removed",{$tag:c}),c})},k.select=function(a){a<0?a=k.items.length-1:a>=k.items.length&&(a=0),k.index=a,k.selected=k.items[a]},k.selectPrior=function(){k.select(--k.index)},k.selectNext=function(){k.select(++k.index)},k.removeSelected=function(){return k.remove(k.index)},k.clearSelection=function(){k.selected=null,k.index=-1},k.clearSelection(),k}function i(a){return-1!==m.indexOf(a)}function j(e,f,h,i){var j,l,m=[k.enter,k.comma,k.space,k.backspace,k.delete,k.left,k.right],n=e.tagList,o=e.events,p=e.options,q=f.find("input"),r=["bbMinTags","bbMaxTags","bbAllowLeftoverText"];j=function(){i.$setValidity("maxTags",n.items.length<=p.bbMaxTags),i.$setValidity("minTags",n.items.length>=p.bbMinTags),i.$setValidity("leftoverText",!(!e.hasFocus&&!p.bbAllowLeftoverText)||!e.newTag.text())},l=function(){b(function(){q[0].focus()})},i.$isEmpty=function(a){return!a||!a.length},e.newTag={text:function(b){if(!a.isDefined(b))return e.text||"";e.text=b,o.trigger("input-change",b)},invalid:null},e.track=function(a){return a[p.bbKeyProperty||p.bbDisplayProperty]},e.getTagClass=function(a,b){var c=a===n.selected;return[e.tagClass({$tag:a,$index:b,$selected:c}),{selected:c}]},e.$watch("tags",function(a){a?(n.items=g.makeObjectArray(a,p.bbDisplayProperty),e.tags=n.items):n.items=[]}),e.$watch("tags.length",function(){j(),i.$validate()}),h.$observe("disabled",function(a){e.disabled=a}),e.eventHandlers={input:{keydown:function(a){o.trigger("input-keydown",a)},focus:function(){e.hasFocus||(e.hasFocus=!0,o.trigger("input-focus"))},blur:function(){b(function(){var a=c.prop("activeElement"),b=a===q[0],d=f[0].contains(a);!b&&d||(e.hasFocus=!1,o.trigger("input-blur"))})},paste:function(a){a.getTextData=function(){var b=a.clipboardData||a.originalEvent&&a.originalEvent.clipboardData;return b?b.getData("text/plain"):d.clipboardData.getData("Text")},o.trigger("input-paste",a)}},host:{click:function(){e.disabled||l()}},tag:{click:function(a){o.trigger("tag-clicked",{$tag:a})}}},o.on("tag-added",e.onTagAdded).on("invalid-tag",e.onInvalidTag).on("tag-removed",e.onTagRemoved).on("tag-clicked",e.onTagClicked).on("tag-added",function(){e.newTag.text("")}).on("tag-added tag-removed",function(){e.tags=n.items,i.$setDirty(),l()}).on("invalid-tag",function(){e.newTag.invalid=!0}).on("option-change",function(a){-1!==r.indexOf(a.name)&&j()}).on("input-change",function(){n.clearSelection(),e.newTag.invalid=null}).on("input-focus",function(){f.triggerHandler("focus"),i.$setValidity("leftoverText",!0)}).on("input-blur",function(){p.bbAddOnBlur&&!p.bbAddFromAutocompleteOnly&&n.addText(e.newTag.text()),f.triggerHandler("blur"),j()}).on("input-keydown",function(a){var b,c,d,f,h=a.keyCode||a.which,i={};g.isModifierOn(a)||-1===m.indexOf(h)||(i[k.enter]=p.bbAddOnEnter,i[k.comma]=p.bbAddOnComma,i[k.space]=p.bbAddOnSpace,b=!p.bbAddFromAutocompleteOnly&&i[h],c=(h===k.backspace||h===k.delete)&&n.selected,f=h===k.backspace&&0===e.newTag.text().length&&p.bbEnableEditingLastTag,d=(h===k.backspace||h===k.left||h===k.right)&&0===e.newTag.text().length&&!p.bbEnableEditingLastTag,b?n.addText(e.newTag.text()):f?(n.selectPrior(),n.removeSelected().then(function(a){a&&e.newTag.text(a[p.bbDisplayProperty])})):c?n.removeSelected():d&&(h===k.left||h===k.backspace?n.selectPrior():h===k.right&&n.selectNext()),(b||d||c||f)&&a.preventDefault())}).on("input-paste",function(a){if(p.bbAddOnPaste){var b=a.getTextData(),c=b.split(p.bbPasteSplitPattern);c.length>1&&(c.forEach(function(a){n.addText(a)}),a.preventDefault())}})}function n(a,b,c){a.events=g.simplePubSub(),f.load("bbInputTag",a,b,{bbTemplate:[String,"bb/tag-item.html"],bbType:[String,"text",i],bbPlaceholder:[String,"Adicione uma tag"],bbTabindex:[Number,null],bbRemoveTagSymbol:[String,String.fromCharCode(215)],bbReplaceSpacesWithDashes:[Boolean,!0],bbMinLength:[Number,3],bbMaxLength:[Number,l],bbAddOnEnter:[Boolean,!0],bbAddOnSpace:[Boolean,!1],bbAddOnComma:[Boolean,!0],bbAddOnBlur:[Boolean,!0],bbAddOnPaste:[Boolean,!1],bbPasteSplitPattern:[RegExp,/,/],bbAllowedTagsPattern:[RegExp,/.+/],bbEnableEditingLastTag:[Boolean,!1],bbMinTags:[Number,0],bbMaxTags:[Number,l],bbDisplayProperty:[String,"text"],bbKeyProperty:[String,""],bbAllowLeftoverText:[Boolean,!1],bbAddFromAutocompleteOnly:[Boolean,!1],bbSpellcheck:[Boolean,!0]}),a.tagList=new h(a.options,a.events,g.handleUndefinedResult(a.onTagAdding,!0),g.handleUndefinedResult(a.onTagRemoving,!0)),this.registerAutocomplete=function(){c.find("input");return{addTag:function(b){return a.tagList.add(b)},getTags:function(){return a.tagList.items},getCurrentTagText:function(){return a.newTag.text()},getOptions:function(){return a.options},getTemplateScope:function(){return a.templateScope},on:function(b,c){return a.events.on(b,c,!0),this}}},this.registerTagItem=function(){return{getOptions:function(){return a.options},removeTag:function(b){a.disabled||a.tagList.remove(b)}}}}var o={restrict:"E",require:"ngModel",scope:{tags:"=ngModel",text:"=?bbText",templateScope:"=?bbTemplateScope",tagClass:"&bbTagClass",onTagAdding:"&bbOnTagAdding",onTagAdded:"&bbOnTagAdded",onInvalidTag:"&bbOnInvalidTag",onTagRemoving:"&bbOnTagRemoving",onTagRemoved:"&bbOnTagRemoved",onTagClicked:"&bbOnTagClicked"},replace:!1,transclude:!0,templateUrl:"bb/input-tag.html",controller:n,link:j};return n.$inject=["$scope","$attrs","$element"],o}function e(a){function b(b,c,d,e){var f=e.registerTagItem(),g=f.getOptions();b.$$template=g.bbTemplate,b.$$removeTagSymbol=g.bbRemoveTagSymbol,b.$getDisplayText=function(){return a.safeToString(b.data[g.bbDisplayProperty])},b.$removeTag=function(){f.removeTag(b.$index)},b.$watch("$parent.$index",function(a){b.$index=a})}return{restrict:"E",require:"^bbInputTag",template:'<ng-include src="$$template"></ng-include>',scope:{$scope:"=scope",data:"="},link:b}}function f(){return function(a,b,c,d,e){e(function(a){b.append(a)})}}function g(){return function(b,c,d){b.$watch(d.tiBindAttrs,function(b){a.forEach(b,function(a,b){d.$set(b,a)})},!0)}}function h(b){function c(c,d,e,f){var g,h,i=b.getTextAutosizeThreshold();g=a.element('<span class="input"></span>'),g.css("display","none").css("visibility","hidden").css("width","auto").css("white-space","pre"),d.parent().append(g),h=function(b){var c,f=b;return a.isString(f)&&0===f.length&&(f=e.bbPlaceholder),f&&(g.text(f),g.css("display",""),c=g.prop("offsetWidth"),g.css("display","none")),d.css("width",c?c+i+"px":""),b},f.$parsers.unshift(h),f.$formatters.unshift(h),e.$observe("bbPlaceholder",function(a){f.$modelValue||h(a)})}return{restrict:"A",require:"ngModel",link:c}}function i(b,c,d,e,f,g){function h(a,b,c){var d,f,h,i={};return h=function(){return b.bbInputTag.bbKeyProperty||b.bbInputTag.bbDisplayProperty},d=function(a,c){return a.filter(function(a){return!g.findInObjectArray(c,a,h(),function(a,c){return b.bbInputTag.bbReplaceSpacesWithDashes&&(a=g.replaceSpacesWithDashes(a),c=g.replaceSpacesWithDashes(c)),g.defaultComparer(a,c)})})},i.reset=function(){f=null,i.items=[],i.visible=!1,i.index=-1,i.selected=null,i.query=null},i.show=function(){b.bbSelectFirstMatch?i.select(0):i.selected=null,i.visible=!0},i.load=g.debounce(function(c,j){i.query=c;var k=e.when(a({$query:c}));f=k,k.then(function(a){k===f&&(a=g.makeObjectArray(a.data||a,h()),a=d(a,j),i.items=a.slice(0,b.bbMaxResultsToShow),i.items.length>0?i.show():i.reset())})},b.bbDebounceDelay),i.selectNext=function(){i.select(++i.index)},i.selectPrior=function(){i.select(--i.index)},i.select=function(a){a<0?a=i.items.length-1:a>=i.items.length&&(a=0),i.index=a,i.selected=i.items[a],c.trigger("suggestion-selected",a)},i.reset(),i}function i(a,b){var c=a.find("li").eq(b),d=c.parent(),e=c.prop("offsetTop"),f=c.prop("offsetHeight"),g=d.prop("clientHeight"),h=d.prop("scrollTop");e<h?d.prop("scrollTop",e):e+f>g+h&&d.prop("scrollTop",e+f-g)}function j(b,c,d,e){var f,h=[k.enter,k.tab,k.escape,k.up,k.down],j=b.suggestionList,l=e.registerAutocomplete(),m=b.options,n=b.events;m.bbInputTag=l.getOptions(),f=function(a){return a&&a.length>=m.bbMinLength||!a&&m.bbLoadOnEmpty},b.bbTemplateScope=l.getTemplateScope(),b.addSuggestionByIndex=function(a){j.select(a),b.addSuggestion()},b.addSuggestion=function(){var b=!1;return j.selected&&(l.addTag(a.copy(j.selected)),j.reset(),b=!0),b},b.track=function(a){return a[m.bbInputTag.bbKeyProperty||m.bbInputTag.bbDisplayProperty]},b.getSuggestionClass=function(a,c){var d=a===j.selected;return[b.matchClass({$match:a,$index:c,$selected:d}),{selected:d}]},l.on("tag-added tag-removed invalid-tag input-blur",function(){j.reset()}).on("input-change",function(a){f(a)?j.load(a,l.getTags()):j.reset()}).on("input-focus",function(){var a=l.getCurrentTagText();m.bbLoadOnFocus&&f(a)&&j.load(a,l.getTags())}).on("input-keydown",function(a){var c=a.keyCode||a.which,d=!1;if(!g.isModifierOn(a)&&-1!==h.indexOf(c))return j.visible?c===k.down?(j.selectNext(),d=!0):c===k.up?(j.selectPrior(),d=!0):c===k.escape?(j.reset(),d=!0):c!==k.enter&&c!==k.tab||(d=b.addSuggestion()):c===k.down&&b.options.bbLoadOnDownArrow&&(j.load(l.getCurrentTagText(),l.getTags()),d=!0),d?(a.preventDefault(),a.stopImmediatePropagation(),!1):void 0}),n.on("suggestion-selected",function(a){i(c,a)})}function l(a,b,c){a.events=g.simplePubSub(),f.load("bbAutoComplete",a,c,{bbTemplate:[String,"bb/auto-complete-match.html"],bbDebounceDelay:[Number,100],bbMinLength:[Number,3],bbHighlightMatchedText:[Boolean,!0],bbMaxResultsToShow:[Number,10],bbLoadOnDownArrow:[Boolean,!1],bbLoadOnEmpty:[Boolean,!1],bbLoadOnFocus:[Boolean,!1],bbSelectFirstMatch:[Boolean,!0],bbDisplayProperty:[String,""]}),a.suggestionList=new h(a.source,a.options,a.events),this.registerAutocompleteMatch=function(){return{getOptions:function(){return a.options},getQuery:function(){return a.suggestionList.query}}}}var m={restrict:"E",require:"^bbInputTag",scope:{source:"&bbSource",matchClass:"&bbMatchClass"},templateUrl:"bb/auto-complete.html",controller:l,link:j};return l.$inject=["$scope","$element","$attrs"],m}function j(a,b){function c(c,d,e,f){var g=f.registerAutocompleteMatch(),h=g.getOptions();c.$$template=h.bbTemplate,c.$index=c.$parent.$index,c.$highlight=function(c){return h.bbHighlightMatchedText&&(c=b.safeHighlight(c,g.getQuery())),a.trustAsHtml(c)},c.$getDisplayText=function(){return b.safeToString(c.data[h.bbDisplayProperty||h.bbInputTag.bbDisplayProperty])}}return{restrict:"E",require:"^bbAutoComplete",template:'<ng-include src="$$template"></ng-include>',scope:{$scope:"=scope",data:"="},link:c}}a.module("bb.inputTag",["bb.inputTag.tmpl"]).provider("inputTagsConfig",b).factory("tiUtil",c).directive("bbInputTag",d).directive("bbAutoComplete",i).directive("tiTagItem",e).directive("tiTranscludeAppend",f).directive("tiBindAttrs",g).directive("tiAutosize",h).directive("tiAutocompleteMatch",j);var k={backspace:8,tab:9,enter:13,escape:27,space:32,up:38,down:40,left:37,right:39,delete:46,comma:188},l=9007199254740991,m=["text","email","url"];c.$inject=["$timeout","$q"],d.$inject=["$timeout","$document","$window","$q","inputTagsConfig","tiUtil"],e.$inject=["tiUtil"],h.$inject=["inputTagsConfig"],i.$inject=["$document","$timeout","$sce","$q","inputTagsConfig","tiUtil"],j.$inject=["$sce","tiUtil"]}(angular);